spring.application.name=Caba

# ========================================
# CONFIGURACIÓN DE BASE DE DATOS
# ========================================

# Usar MySQL local por defecto
spring.datasource.url=jdbc:mysql://localhost:3306/caba_pro?useSSL=false&serverTimezone=UTC&allowPublicKeyRetrieval=true
spring.datasource.driverClassName=com.mysql.cj.jdbc.Driver
spring.datasource.username=caba_user
spring.datasource.password=caba_pass

# ========================================
# CONFIGURACIÓN JPA/HIBERNATE
# ========================================

# Dialecto para MySQL
spring.jpa.database-platform=org.hibernate.dialect.MySQLDialect

# Configuración general de Hibernate
# IMPORTANTE: Flyway maneja las migraciones, Hibernate solo usa las tablas existentes
spring.jpa.hibernate.ddl-auto=none
spring.jpa.show-sql=true
spring.jpa.properties.hibernate.format_sql=true
spring.jpa.properties.hibernate.use_sql_comments=true

# ========================================
# CONFIGURACIÓN FLYWAY (Migraciones de BD)
# ========================================

spring.flyway.enabled=true
spring.flyway.locations=classpath:db/migration
spring.flyway.baseline-on-migrate=true
spring.flyway.baseline-version=0
spring.flyway.validate-on-migrate=false
spring.flyway.clean-disabled=false
spring.flyway.out-of-order=true

# ========================================
# CONFIGURACIÓN H2 CONSOLE
# ========================================

spring.h2.console.enabled=true
spring.h2.console.path=/h2-console
spring.h2.console.settings.web-allow-others=false
spring.h2.console.settings.trace=false

# ========================================
# CONFIGURACIÓN DE SERVIDOR
# ========================================

server.port=8081
server.servlet.context-path=/

# ========================================
# CONFIGURACIÓN DE INTERNACIONALIZACIÓN
# ========================================

# Ubicación de los archivos de mensajes
spring.messages.basename=classpath:messages

# Codificación de los archivos de propiedades
spring.messages.encoding=UTF-8

# Caché de mensajes (segundos). -1 para desactivar en desarrollo
spring.messages.cache-duration=-1

# Si no encuentra una clave, usar el código como mensaje por defecto
spring.messages.use-code-as-default-message=true

# Fallback al idioma por defecto si no se encuentra traducción
spring.messages.fallback-to-system-locale=false

# ========================================
# CONFIGURACIÓN DE SESIONES
# ========================================

# Tiempo de vida de la sesión (30 minutos)
server.servlet.session.timeout=30m

# Configuración de cookies de sesión
server.servlet.session.cookie.http-only=true
server.servlet.session.cookie.secure=false
server.servlet.session.cookie.same-site=lax

# Nombre de la cookie de sesión
server.servlet.session.cookie.name=CABA_SESSION

# Tracking mode - permite múltiples pestañas
server.servlet.session.tracking-modes=cookie

# ========================================
# CONFIGURACIÓN DE LOGGING
# ========================================

logging.level.org.springframework.web=DEBUG
logging.level.com.pagina.Caba=DEBUG
logging.level.org.hibernate.SQL=DEBUG
logging.level.org.hibernate.type.descriptor.sql.BasicBinder=TRACE

# ========================================
# CONFIGURACIÓN DE JACKSON
# ========================================

spring.jackson.serialization.write-dates-as-timestamps=false
spring.jackson.time-zone=America/Bogota

# ========================================
# CONFIGURACIÓN DE VALIDACIÓN
# ========================================

spring.jpa.properties.hibernate.validator.apply_to_ddl=false

# ========================================
# CONFIGURACIÓN DE API EXTERNA - OPENWEATHERMAP
# ========================================

# API Key de OpenWeatherMap (obtener en: https://openweathermap.org/api)
# IMPORTANTE: Reemplazar 'demo' con tu API key real
openweather.api.key=686b8fa01def47624a0f07d3dc07cea6
openweather.api.url=https://api.openweathermap.org/data/2.5
# Ciudad por defecto para el widget del clima
openweather.default-city=Medellin

# Configuración de caché (5 minutos = 300 segundos)
spring.cache.cache-names=weatherCache
spring.cache.caffeine.spec=maximumSize=100,expireAfterWrite=300s

# ========================================
# CONFIGURACIÓN JWT - ENTREGABLE #3
# ========================================

# Secret key para firmar los tokens JWT (debe ser lo suficientemente largo para HS512)
jwt.secret=CABAProSecretKeyForJWTAuthentication2025ThisMustBeLongEnoughForHS512Algorithm

# Tiempo de expiración del token en milisegundos (24 horas = 86400000 ms)
jwt.expiration=86400000

# Configuración de CORS para API REST
cors.allowed-origins=http://localhost:3000,http://localhost:4200,http://localhost:5173

# ========================================
# CONFIGURACIÓN AWS S3 - Almacenamiento de Imágenes
# ========================================

# Bucket de S3 para almacenar imágenes
aws.s3.bucket-name=caba-pro-images
aws.s3.region=us-east-1

# Credenciales de AWS (se configuran via variables de entorno en producción)
# AWS_ACCESS_KEY_ID y AWS_SECRET_ACCESS_KEY se leen automáticamente
# Para desarrollo local, usar AWS CLI: aws configure

# Configuración de subida de archivos
spring.servlet.multipart.enabled=true
spring.servlet.multipart.max-file-size=10MB
spring.servlet.multipart.max-request-size=10MB
spring.servlet.multipart.file-size-threshold=2KB

# Directorio temporal para archivos
spring.servlet.multipart.location=${java.io.tmpdir}
